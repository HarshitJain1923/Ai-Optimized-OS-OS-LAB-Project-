# Custom Pop!_OS Build Environment

This repository contains a Makefile and configuration files to build a customized Pop!_OS ISO image. This specific configuration focuses on pre-installing tools useful for GPU computing and monitoring.

## Overview

The primary goal of this build configuration is to create a Pop!_OS (`22.04` by default) ISO that comes ready with:

1.  **NVIDIA CUDA Toolkit:** Essential for GPU-accelerated computing tasks, particularly in machine learning and scientific computing.
2.  **Custom Python GPU Monitor:** A simple graphical tool to monitor GPU usage, built using Python, Tkinter, pynvml, and Matplotlib.

These additions are integrated during the ISO build process defined in the `Makefile`.

## Key Modifications (Reflected in `Makefile`)

The standard ISO build process (`iso` target in the `Makefile`) has been modified to include the following steps:

1.  **Install CUDA:**
    * Updates the package list (`sudo apt-get update`).
    * Installs the `cuda` package using APT (`sudo apt-get install -y cuda`). This provides the necessary NVIDIA drivers, CUDA toolkit, and libraries required to run CUDA-enabled applications.
    * *Note:* While CUDA is installed, specific frameworks like PyTorch or TensorFlow **are not** installed by this script. However, the pre-installed CUDA toolkit enables users to easily install GPU-accelerated versions of these frameworks post-installation (e.g., via `pip`).

2.  **Install GPU Monitor Dependencies:**
    * Installs necessary system packages: `python3-tk` (for the GUI) and `python3-pip` (for Python package management) using APT.
    * Installs required Python libraries: `pynvml` (for NVIDIA GPU information) and `matplotlib` (for plotting, if used by `gpu.py`) using `pip`.

3.  **Copy GPU Monitor Files:**
    * Creates a directory `/opt/gpu-monitor` within the ISO build environment.
    * Copies the custom GPU monitor script (`gpu.py`) and its icon (`gpu.png`) to `/opt/gpu-monitor`.
    * **Important:** You **must** replace the placeholder paths (`path/to/gpu.py` and `path/to/gpu.png`) in the `Makefile` with the actual paths to your script and icon relative to the build environment or use absolute paths accessible during the build.

4.  **Create Desktop Shortcut:**
    * Creates a `.desktop` file (`gpu-monitor.desktop`) in `/usr/share/applications` within the ISO build environment.
    * This makes the "GPU Monitor" application easily launchable from the system's application menu after installation.

5.  **Set Executable Permissions:**
    * Makes the `gpu.py` script executable (`sudo chmod +x`).

## Prerequisites for Building

Before running `make`, ensure you have:

* A Linux environment (preferably Debian/Ubuntu-based).
* Standard build tools (`make`, etc.).
* Dependencies required by the Pop!_OS build system (refer to Pop!_OS documentation if needed).
* The `gpu.py` script and `gpu.png` icon file available at the locations you specify in the `Makefile`.
* Sufficient disk space for the build process and the final ISO.
* `sudo` privileges are required for many build steps.

## How to Build

1.  **Configure:** Review the configuration variables at the top of the `Makefile` (`DISTRO_CODE`, `DISTRO_VERSION`, etc.) and adjust if necessary.
2.  **Update Paths:** **Crucially**, edit the `iso:` target in the `Makefile` and replace `path/to/gpu.py` and `path/to/gpu.png` with the correct paths to your files.
3.  **Build the ISO:** Open a terminal in the directory containing the `Makefile` and run:
    ```bash
    make iso
    ```
4.  **Build All Components (Optional):** To build the ISO, zsync file, and checksums:
    ```bash
    make all
    ```

The resulting ISO file will be located in the `build/` directory (or as configured by the included makefiles).

## Post-Installation Notes

After installing Pop!_OS using the ISO generated by this `Makefile`:

* The NVIDIA CUDA Toolkit will be pre-installed. You can verify this by checking for `nvcc` or NVIDIA driver tools.
* The "GPU Monitor" application should be available in your application menu (usually found under Utilities or System Tools). You can launch it to monitor your GPU.
* You will still need to install GPU-accelerated versions of frameworks like PyTorch or TensorFlow separately if required, but they will be able to utilize the pre-installed CUDA toolkit.



# Pop!\_OS ISO production

This repository contains the tools necessary for building Pop!\_OS ISOs.

## Requirements

First you need to import the Pop!\_OS ISO signing key:

```sh
gpg --recv-keys 204DD8AEC33A7AFF
```

Then you need to generate your own GPG key and upload it to a keyserver:

```sh
gpg --full-gen-key
gpg --send-keys --keyserver keyserver.ubuntu.com ${YOUR_KEY_ID_HERE}
```

While you are waiting for your key to be uploaded, install the dependencies:

```sh
./deps.sh
```

## Building

The build is controlled by the Makefile. The following commands can be used:
- `make` - Build an ISO at `build/17.10/pop-os.iso`
- `make qemu_bios` - Run the ISO in BIOS mode
- `make qemu_uefi` - Run the ISO in UEFI mode
- `make clean` - Remove the build files, keeping the debootstrap
- `make distclean` - Remove the debootstrap and other build files

The configuration can be changed in `mk/config.mk`.

To rebuild the ISO when you have made changes, you can use `make clean && make`
